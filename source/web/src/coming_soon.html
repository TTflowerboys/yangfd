<!doctype html>
<html>
    <head>
        <!-- @@include = partials/meta.html -->

        <!-- @@include =partials/css_import.html -->

        <link rel="stylesheet" href="/static/styles/comingSoon.css"/>

        <!--[if lte IE 8]>
        <script src="/static/vendors/html5shiv.min.js"></script>
        <![endif]-->

    </head>
    <body>

        <div class="opening">
            <div class="opening_inner">
                <img class="logo" src="/static/images/logo-yfd.png" alt=""/>
                <h1 class="hint">金秋十月，即将开放！</h1>
                <form name="subscription" class="subscription">
                    <input class="email" name="email" type="text" placeholder="E-Mail" data-validator="required, trim email"/>
                    <button type="submit" class="button red">订阅</button>
                    <p class="resultMessage"></p>
                </form>
                <img class="wechat" src="/static/images/media/wechat.png" alt=""/>
            </div>
        </div>
        <div class="whatWeDo_wrapper">
            <div class="whatWeDo">
                <h2 class="title">我们做什么?</h2>
                <p class="description">我们专注于为投资人提供多样化的海外投资置业机会，以丰富的投资分析报告和专业的置业顾问助推您的海外投资之路。<br>
                    <br>
                    洋房东将首先在中国和英国上线，为您提供英国的楼盘、公寓、别墅、学区房等多样化的海外置业机会，同时可以根据您的投资意向和预算为您推荐最合适的投资机
                    <br>会，辅以详细的房产信息和街区投资分析报告帮助您决策，当您确定投资意向时，联系平台的职业顾问，协助您完成投资流程，轻松当洋房东。
                </p>
            </div>
        </div>
        <div class="requirement">
            <div class="requirement_title">
                <h2 class="title">提交置业需求</h2>
                <h3 class="subtitle">如果您有购买房子的意向，请告诉我们，我们将收集相应的资源并且
                    及时反馈给您
                </h3>
            </div>
            <form class="requirement_form"  name="requirement">
                <div class="form_row">
                    <input class="name ghostInput" name="nickname" type="text" placeholder="姓名" data-validator="required, trim"/>
                </div>
                <div class="form_row">
                    <input class="phone ghostInput" name="phone" type="text" placeholder="电话" data-validator="required, trim number"/>
                </div>
                <div class="form_row">
                    <input class="email ghostInput" name="email" type="text" placeholder="邮箱" data-validator="required, trim email"/>
                </div>
                <div class="form_row">
                    <p class="budgetHint">您的预算</p>
                </div>
                <div class="form_row">
                    <select class="budget ghostSelect" name="budget">
                        <option value="100">100万以下</option>
                        <option value="300">100万到300万</option>
                        <option value="500" selected="selected">300万到500万</option>
                        <option value="1000">500万到1000万</option>
                        <option value="1001">1000万以上</option>
                    </select>
                </div>
                <div class="form_row">
                    <textarea class="detail ghostTextArea" name="description" placeholder="写下您的其他需求和描述，方便我们在挑选房源时作为参考"></textarea>
                </div>
                <div class="form_row">
                    <button type="submit" class="button red">提交</button>
                </div>
                <p class="resultMessage"></p>
            </form>
        </div>

        <div id="copyright" class="copyright">
            <p>&copy;<script>document.write(new Date().getFullYear())</script>
                Brothers Bridge Group
            </p>
        </div>

        <!-- @@include =partials/js_import.html -->
        <script>
            $(window).on('resize', function () {
                $('#main').css({minHeight: $(window).height() - $('#copyright').height()})
            })
            $(function () {
                $('#main').css({minHeight: $(window).height() - $('#copyright').height()})
            })
        </script>

        <script>

            function errorMessageFormValidatorType(validator) {
                if (validator == "required") {
                    return "不能为空"
                }
                else if (validator == "number")
                {
                    return "格式不正确"
                }
                else if (validator == "email")
                {
                    return "格式不合法"
                }
            }

            $('form[name=subscription]').submit(function (e) {
                e.preventDefault()
                var resultArea=  $(this).find(".resultMessage")
                resultArea.hide()

                var valid = $.validate(this, {onError: function (dom,validator,index) {
                    resultArea.text("邮箱" + errorMessageFormValidatorType(validator))
                    resultArea.show()
                }})
                if(!valid){return}
                var params = $(this).serializeObject()
                $.post("/api/1/subscription/add",
                        params,
                        function (data, status) {
                            if (data.ret != 0) {
                                resultArea.text("订阅失败！")
                                resultArea.show()
                            }
                            else {
                                resultArea.text("恭喜你，订阅成功！")
                                resultArea.show()
                            }
                        });
            })

            $('form[name=requirement]').submit(function (e) {
                e.preventDefault()
                var resultArea=  $(this).find(".resultMessage")
                resultArea.hide()

                var valid = $.validate(this, {onError: function (dom,validator,index) {
                    resultArea.text(dom.placeholder + errorMessageFormValidatorType(validator))
                    resultArea.show()
                }})
                if(!valid){return}
                var params = $(this).serializeObject()
                //TODO: 需要更新 budget 的类型
                $.post("/api/1/intention_ticket/add",
                        params,
                        function (data, status) {
                            if (data.ret != 0) {
                                resultArea.text("提交置业需求失败！")
                                resultArea.show()
                            }
                            else {
                                resultArea.text("恭喜你，一成功提交置业需求！")
                                resultArea.show()
                            }
                        });
            })

        </script>

    </body>
</html>

