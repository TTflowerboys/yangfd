<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="UTF-8">
        <title>出租房产微信展示页</title>
        <meta name="viewport" content="width=device-width,height=device-height,inital-scale=1.0,maximum-scale=1.0,user-scalable=no;">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="format-detection" content="telephone=no">
        <!--build:css(dist) /static/styles/wechat_poster.html.css-->
        <link rel="stylesheet" href="/static/styles/team/reset.less">
        <link rel="stylesheet" href="/static/vendors/swiper/swiper.min.css">
        <link rel="stylesheet" href="/static/styles/phone/animation.css">
        <link rel="stylesheet" href="/static/styles/phone/wechatPoster.css">


        <!--endbuild-->
        <!--<link rel="stylesheet" href="http://c.animate.com/css/companyslide/wyy-base-pc.css?v=1.5.5.7_034455">-->
        <!--<link rel="stylesheet" href="http://c.animate.com/css/companyslide/wyy-animation.css?v=1.5.5.7_034455">-->
    </head>
    <body marginwidth="0" marginheight="0" class="loading">
        <div class="loadingCover">
            <div class="proBox">
                <canvas id="procanvas" class="procanvas" value="0%"></canvas>
                <span id="proText" class="proText"></span>
            </div>
            <p class="info">正在加载资源<br>请稍后</p>
            <p class="logo"></p>
        </div>
        <script type="text/javascript">
            window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame
            window.cancelAnimationFrame = window.cancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame || window.msCancelAnimationFrame
            //进度条类
            function Process(conf){
                var defaultConfig = {

                }
                var config = {}
                extendConfig()
                var _ = this
                var canvas = document.getElementById(config.canvasId)
                var context = canvas.getContext('2d')
                var textEle = document.getElementById(config.textId)
                this.canvasvalue = canvas.getAttribute("value") || '0%'
                this.process = parseInt(this.canvasvalue.substring(0, this.canvasvalue.length - 1))
                this.scale = window.devicePixelRatio || 1
                this.outerWidth = config.outerWidth
                this.innerWidth = config.innerWidth
                this.center = [this.outerWidth / 2 * this.scale, this.outerWidth / 2 * this.scale]

                canvas.width = this.outerWidth * this.scale
                canvas.height = this.outerWidth * this.scale

                canvas.style.width = this.outerWidth + 'px'
                canvas.style.height = this.outerWidth + 'px'

                initStyle()

                this.draw = function () {
                    //开始画一个underColor的圆
                    context.beginPath()
                    context.moveTo(this.center[0], this.center[1])
                    context.arc(this.center[0], this.center[1], this.center[0], 0, Math.PI * 2, false)
                    context.closePath()
                    context.fillStyle = config.underColor
                    context.fill()

                    // 画进度(activeColor)
                    if(this.process !== 0 && this.process !== 100){
                        context.beginPath()
                        context.moveTo(this.center[0], this.center[1])
                        context.arc(this.center[0], this.center[1], this.center[0], - Math.PI / 2, Math.PI*2* (this.process / 100) - Math.PI / 2, false)
                        context.closePath()
                        context.fillStyle = config.activeColor
                        context.fill()
                    }
                    else if(this.process === 100){
                        context.beginPath()
                        context.moveTo(this.center[0], this.center[1])
                        context.arc(this.center[0], this.center[1], this.center[0], 0, Math.PI*2, false)
                        context.closePath()
                        context.fillStyle = config.activeColor
                        context.fill()
                    }
                    // 画内部空白(backColor)
                    context.beginPath()
                    context.moveTo(this.center[0], this.center[1])
                    context.arc(this.center[0], this.center[1], this.center[0]*this.innerWidth/this.outerWidth, 0, Math.PI * 2, true)
                    context.closePath()
                    context.fillStyle = config.backColor
                    context.fill()
                }
                this.changeText = function () {
                    this.canvasvalue = this.process + '%';
                    textEle.innerHTML = this.canvasvalue
                }
                function initStyle(){
                    var w = _.outerWidth + 'px'
                    canvas.parentElement.style.width = w
                    canvas.parentElement.style.height = w
                    canvas.nextElementSibling.style.lineHeight = w
                }
                function extendConfig(){
                    var k
                    for(k in defaultConfig){
                        config[k] = defaultConfig[k]
                    }
                    for(k in conf){
                        config[k] = conf[k]
                    }
                }

            }
            Process.prototype.moveTo = function(process, time, callback){
                var _ = this,
                    time = time || 3000,
                    past = new Date,
                    now,
                    pastProcess = this.process,
                    step = process - this.process
                if(_.raf !== undefined){
                    cancelAnimationFrame(_.raf)
                }
                function move(){
                    now = new Date
                    if((now - past) / time >= (_.process - pastProcess) / step){
                        _.process =  Math.min(pastProcess + Math.floor((now - past) / time * step), process)
                        _.draw()
                        _.changeText()
                    }
                    if(_.process < process){
                        _.raf = requestAnimationFrame(move)
                    }
                    if(_.process === process){
                        setTimeout(function(){
                            callback && typeof callback === 'function' && callback()
                        },200)
                    }
                }
                _.raf = requestAnimationFrame(move)
            }
            Process.prototype.finish = function(cb){
                this.moveTo(100, 500, cb)
            }
            var process = new Process({
                canvasId: 'procanvas',
                textId: 'proText',
                outerWidth: '100',
                innerWidth: '94',
                backColor: 'rgba(51,51,51,1)',
                underColor: '#3f3f3f',
                activeColor: '#aec227'
            })
            process.moveTo(80, 10000, function(){
                process.moveTo(90, 5000)
            })
        </script>
        <div class="swiper-container" style="">
            <div class="swiper-wrapper" style="">
                <div class="swiper-slide swiper-slide-bg commen" style="">
                    <div class="page page_1">
                        <div class="topTitleNav animate">
                            <p class="location animate">英国 伦敦 金丝雀码头</p>
                            <p class="title animate">两室一厅好房整租</p>
                            <p class="titleEn animate">Letting!</p>
                        </div>
                    </div>
                    <div class="bottomBox animate">
                        <div class="scrollUp">继续</div>
                    </div>
                </div>
                <div class="swiper-slide swiper-slide-bg commen" style="">
                    <div class="page page_2">
                        <p class="line1 animate">仅需</p>
                        <p class="line2 animate"><span>¥ 4,000/周,</span><sub>包Bill</sub></p>
                        <p class="line3 animate">您就可以租到</p>
                    </div>
                    <div class="bottomBox animate">
                        <div class="scrollUp">继续</div>
                    </div>
                </div>


            </div>

        </div>

        <!--build:js /static/scripts/wechat_poster.html.js-->
        <script type="text/javascript" src="/static/vendors/jquery/jquery-2.1.0.min.js"></script>
        <script type="text/javascript" src="/static/vendors/swiper/swiper.jquery.min.js"></script>
        <!--endbuild-->

        <script>
            var mySwiper = new Swiper('.swiper-container', {
                direction: 'vertical',
                effect: 'coverflow',
                coverflow: {
                    rotate: 50,
                    stretch: 0,
                    depth: 100,
                    modifier: 1,
                    slideShadows : true
                },
                /*cube: {
                    slideShadows: true,
                    shadow: true,
                    shadowOffset: 20,
                    shadowScale: 0.94
                },*/
                onInit: function (swiper, direction) {
                    var index = swiper.activeIndex
                    var height = $(window).innerHeight()
                    var obj = $(".swiper-slide")
                    obj.not(".swiper-slide-visible").find(".animate").addClass('hide')
//                    obj.eq(index).find(".animate").removeClass("hide")
                },
                onSlideChangeEnd: function (swiper, direction) {
                    var index = swiper.activeIndex
                    var obj = $(".swiper-slide")
                    //companyHeightReset()
                    obj.eq(index).siblings().find(".animate").addClass('hide')
                    obj.eq(index).find(".animate").removeClass("hide")
                }
            });
            $('.loadingCover').css({
                height: $(window).height()
            })
            $(window).load(function(){
                //所有资源加载完毕后：
                function loadCallback(){
                    $('.loadingCover').fadeOut(200, function(){
                        $('body').removeClass('loading')
                        $(".swiper-slide").eq(0).find('.animate').removeClass('hide')
                    })
                }
                setTimeout(function(){
                    process.finish(loadCallback)
                },0)
            })

        </script>

    </body>
</html>