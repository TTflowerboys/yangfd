<div ui-view>
    <div class="buttons">

        <span class="btn-group">
            <button class="btn" ng-click="$state.go('^')"><span class="fa fa-chevron-left"></span>返回</button>
        </span>

    </div>

    <div add-property-items></div>
    <hr/>

    <form class="form-horizontal" method="post" autocomplete="on" ng-class="{submitted:submitted}"
        ng-submit="submit($event,createProperty)" name="createProperty" novalidate>
        <div class="row">
            <div class="form-group col-sm-3">
                <select class="form-control" ng-options="p.value as p.name for p in i18nLanguages"
                    ng-model="userLanguage.value"></select>
            </div>
            <div class="form-group col-sm-3">
                <select class="form-control" ng-options="item for item in i18nArea" ng-model="userArea">
                    <option value="">-- 面积单位 --</option>
                </select>
            </div>
            <div class="form-group col-sm-3">
                <select class="form-control" ng-options="item for item in i18nCurrency" ng-model="userCurrency">
                    <option value="">-- 货币单位 --</option>
                </select>
            </div>
        </div>
        <tabset justified="true" style="margin: 16px 0;" ng-if="userLanguage.value && userArea && userCurrency">
            <tab heading="房产通用信息">
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">名称</label>

                        <div class="controls">
                            <input type="text" class="form-control" type-i18n="item.name" ng-model="item.name[userLanguage.value]"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">房产类型</label>

                        <div class="controls">
                            <div enum-select name="property_type" ng-model="item.property_type"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">国家</label>

                        <div class="controls">
                            <div enum-select name="country" ng-model="item.country"></div>

                        </div>
                    </div>
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">城市</label>

                        <div class="controls">
                            <div city-select-by-country country="item.country" ng-model="item.city"></div>

                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">街区</label>

                        <div class="controls">
                            <input type="text" class="form-control" type-i18n="item.street" ng-model="item.street[userLanguage.value]"/>
                        </div>
                    </div>
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">邮编</label>

                        <div class="controls">
                            <input type="text" class="form-control" type-i18n="item.zipcode"
                                ng-model="item.zipcode[userLanguage.value]"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-6">
                        <label class="control-label">地址详情</label>

                        <div class="controls">
                            <input type="text" class="form-control" type-i18n="item.address"
                                ng-model="item.address[userLanguage.value]"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-6">

                        <div class="controls">
                            <div type-i18n="item.highlight"></div>
                            <table class="table table-bordered table-striped table-condensed "
                                style="margin-bottom:30px">
                                <colgroup>
                                    <col class="highlight">
                                    <col class="delete">
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>亮点</th>
                                        <th>删除</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="point in item.highlight[userLanguage.value] track by $index">
                                        <td>
                                            <input type="text" ng-model="item.highlight[userLanguage.value][$index]"/>
                                        </td>
                                        <td>
                                            <span class="btn btn-danger" ng-click="onRemoveHighlight($index)" title="Remove">
                                                <i class="fa fa-trash-o"></i>
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <input type="button" ng-click="addHighlight()" class="btn btn-primary" value="添加亮点">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12">
                        <label class="control-label">详情</label>

                        <div class="controls">
                            <textarea ng-model="item.description[userLanguage.value]" class="form-control" type-i18n="item.description" rows="4"></textarea>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">年化回报预估</label>

                        <div class="controls">
                            <input type="text" class="form-control" ng-model="item.annual_return_estimated"/>
                        </div>
                    </div>
                </div>
                <div class="row">

                    <div class="form-group  col-xs-12 col-sm-12">
                        <label class="control-label">投资标签</label>
                        <div class="controls">
                            <div multi-enum-select name="intention" ng-model="item.intention"></div>
                        </div>
                    </div>
                </div>
                <div class="row">

                    <div class="form-group  col-xs-12 col-sm-12">
                        <label class="control-label">投资类型</label>
                        <div class="controls">
                            <div multi-enum-select name="investment_type" ng-model="item.investment_type"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">产权类型</label>

                        <div class="controls">
                            <div enum-select name="equity_type" ng-model="item.equity_type"></div>

                        </div>
                    </div>
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">装修风格</label>

                        <div class="controls">
                            <div enum-select name="decorative_style" ng-model="item.decorative_style"></div>

                        </div>
                    </div>
                </div>
                <hr/>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-6">
                        <label class="control-label">地图位置</label>

                        <div class="form-inline">
                            <input type="text" class="form-control col-xs-6 col-sm-3" ng-model="item.latitude"
                                placeholder="Latitude"/>
                            <input type="text" class="form-control col-xs-6 col-sm-3" ng-model="item.longitude"
                                placeholder="Longitude"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12">
                        <label class="control-label">实景图</label>

                        <div class="controls">
                            <div type-i18n="item.reality_images"></div>
                            <images-edit ng-model="item.reality_images[userLanguage.value]" width-limit="1920" ratio="2"
                                thumbnail-size="800,400" text="添加图片"></images-edit>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12">
                        <label class="control-label">生活配设施图</label>

                        <div class="controls">
                            <div type-i18n="item.surroundings_images"></div>
                            <images-edit ng-model="item.surroundings_images[userLanguage.value]" width-limit="1920" ratio="2"
                                thumbnail-size="800,400" text="添加图片"></images-edit>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">房产价格类型</label>
                        <div class="controls">
                            <div enum-select name="property_price_type" ng-model="item.property_price_type"></div>

                        </div>
                    </div>
                </div>
                <div class="row" ng-if="item.property_price_type === '5417fab8c6e47b1566a8a98a'">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">同等房产描述</label>

                        <div class="controls">
                            <input type="text" class="form-control" type-i18n="item.equal_property_description"
                                ng-model="item.equal_property_description[userLanguage.value]"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-6">
                        <label class="control-label">历史成交价格</label>

                        <div class="controls">
                            <table class="table table-bordered table-striped table-condensed "
                                style="margin-bottom:30px">
                                <colgroup>
                                    <col class="item">
                                    <col class="price">
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>成交时间</th>
                                        <th>成交价格</th>
                                        <th>删除</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="price in item.historical_price">
                                        <td>
                                            <date-edit style="width: 185px;" ng-model="price.time"></date-edit>
                                        </td>
                                        <td>
                                            <div type-i18n-unit unit="price.price.unit||userCurrency" data="i18nCurrency" ng-model="price.price"
                                                placeholder="成交价格"></div>
                                        </td>
                                        <td>
                                            <span class="btn btn-danger" ng-click="onRemoveHistoricalPrice($index)" title="Remove">
                                                <i class="fa fa-trash-o"></i>
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="3">
                                            <input type="button" ng-click="addHistoricalPrice()" class="btn btn-primary" value="添加历史成交价格">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
                <hr/>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12">
                        <label class="control-label">估计月租金收入</label>
                        <div class="controls">
                            <div type-i18n-unit unit="userCurrency" data="i18nCurrency" ng-model="item.estimated_monthly_rent"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">估计月平均支出</label>

                        <div class="controls">
                            <table class="table table-bordered table-striped table-condensed"
                                style="margin-bottom:30px">
                                <colgroup>
                                    <col class="item">
                                    <col class="price">
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>支出名称</th>
                                        <th>支出费用</th>
                                        <th>删除</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="cost in item.estimated_monthly_cost">
                                        <td>
                                            <input type="text" type-i18n="cost.item" ng-model="cost.item[userLanguage.value]"
                                                placeholder="支出名称" class="form-control"/>
                                        </td>
                                        <td>
                                            <div type-i18n-unit unit="cost.price.unit||userCurrency" ng-model="cost.price" data="i18nCurrency" placeholder="支出费用"></div>
                                        </td>
                                        <td>
                                            <span class="btn btn-danger" ng-click="onRemoveCost($index)" title="Remove">
                                                <i class="fa fa-trash-o"></i>
                                            </span>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td colspan="3">
                                            <input type="button" ng-click="addCost()" class="btn btn-primary" value="添加">
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </tab>
            <tab heading="非楼盘特有信息" ng-if="item.property_type !== '54100a14c6e47b14331ad29f'">
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">总价格</label>
                        <div class="controls">
                            <div type-i18n-unit unit="userCurrency" data="i18nCurrency" ng-model="item.total_price" placeholder="总价格"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-4 col-sm-2">
                        <label class="control-label">居室数</label>

                        <div class="controls">
                            <input type="number" class="form-control" ng-model="item.bedroom_count"/>
                        </div>
                    </div>
                    <div class="form-group col-xs-4 col-sm-2">
                        <label class="control-label">客厅数</label>

                        <div class="controls">
                            <input type="number" class="form-control" ng-model="item.living_room_count"/>
                        </div>
                    </div>
                    <div class="form-group col-xs-4 col-sm-2">
                        <label class="control-label">卫生间数</label>

                        <div class="controls">
                            <input type="number" class="form-control" ng-model="item.bathroom_count"/>
                        </div>
                    </div>
                    <div class="form-group col-xs-4 col-sm-2">
                        <label class="control-label">厨房数</label>

                        <div class="controls">
                            <input type="number" class="form-control" ng-model="item.kitchen_count"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">朝向</label>

                        <div class="controls">
                            <div enum-select name="facing_direction" ng-model="item.facing_direction"></div>

                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">面积</label>

                        <div class="controls">
                            <div type-i18n-unit unit="userArea" data="i18nArea" ng-model="item.space"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12">
                        <label class="control-label">户型图</label>

                        <div class="controls">
                            <div type-i18n="item.floor_plan"></div>
                            <images-edit text="添加图片" ng-model="item.floor_plan[userLanguage.value]" width-limit="1920"
                                ratio="2" thumbnail-size="800,400"></images-edit>
                        </div>
                    </div>
                </div>
            </tab>
            <tab heading="楼盘信息" ng-if="item.property_type === '54100a14c6e47b14331ad29f'">
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">开发商</label>

                        <div class="controls">
                            <input type="text" class="form-control" type-i18n="item.developer"
                                ng-model="item.developer[userLanguage.value]"/>
                        </div>
                    </div>
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">建筑类型</label>

                        <div class="controls">
                            <input type="text" class="form-control" type-i18n="item.building_type"
                                ng-model="item.building_type[userLanguage.value]"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group row col-xs-6 col-sm-6">
                        <label class="control-label">单位面积参考价格</label>

                        <div class="controls form-inline">
                            <div type-i18n-unit unit="userCurrency" data="i18nCurrency" ng-model="item.unit_price.price"></div>
                            <div type-i18n-unit unit="userArea" data="i18nArea" ng-model="item.unit_price.unit"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-8 col-sm-4">
                        <label class="control-label">开盘时间</label>

                        <div class="controls">
                            <date-edit ng-model="item.opening_time"></date-edit>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">建筑面积</label>

                        <div class="controls">
                            <div type-i18n-unit unit="userArea" data="i18nArea" ng-model="item.building_area"></div>
                        </div>
                    </div>
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">规划面积</label>

                        <div class="controls">
                            <div type-i18n-unit unit="userArea" data="i18nArea" ng-model="item.planning_area"></div>
                        </div>
                    </div>
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">容积率</label>

                        <div class="controls">
                            <input type="text" class="form-control" ng-model="item.plot_ratio"/>
                        </div>
                    </div>
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">绿化率</label>

                        <div class="controls">
                            <input type="text" class="form-control" ng-model="item.greening_rate"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">规划户数</label>

                        <div class="controls">
                            <input type="number" class="form-control" ng-model="item.planning_household_count"/>
                        </div>
                    </div>
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">车位数</label>

                        <div class="controls">
                            <input type="number" class="form-control" ng-model="item.parking_space_count"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">物业类型</label>

                        <div class="controls">
                            <input type="text" class="form-control" type-i18n="item.property_management_type"
                                ng-model="item.property_management_type[userLanguage.value]"/>
                        </div>
                    </div>
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">物业公司</label>

                        <div class="controls">
                            <input type="text" class="form-control" type-i18n="item.property_management_company"
                                ng-model="item.property_management_company[userLanguage.value]"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12">
                        <label class="control-label">主要户型</label>

                        <div class="controls">
                            <table class="table table-bordered table-striped table-condensed"
                                style="margin-bottom:30px">
                                <colgroup>
                                    <col class="name">
                                    <col class="bedroom_count">
                                    <col class="living_room_count">
                                    <col class="bathroom_count">
                                    <col class="kitchen_count">
                                    <col class="space">
                                    <col class="total_price">
                                    <col class="floor_plan">
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>户型名</th>
                                        <th>居室数</th>
                                        <th>客厅数</th>
                                        <th>卫生间数</th>
                                        <th>厨房数</th>
                                        <th>面积</th>
                                        <th>户型总价</th>
                                        <th>户型图</th>
                                        <th>删除</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="main_type in item.main_house_types">
                                        <td>
                                            <input type="text" type-i18n="main_type.name" ng-model="main_type.name[userLanguage.value]" placeholder="户型名"/>
                                        </td>
                                        <td>
                                            <input type="number" ng-model="main_type.bedroom_count" placeholder="居室数" style="width:60px"/>
                                        </td>
                                        <td>
                                            <input type="number" ng-model="main_type.living_room_count" placeholder="客厅数" style="width:60px"/>
                                        </td>
                                        <td>
                                            <input type="number" ng-model="main_type.bathroom_count" placeholder="卫生间数" style="width:80px"/>
                                        </td>
                                        <td>
                                            <input type="number" ng-model="main_type.kitchen_count" placeholder="厨房数" style="width:60px"/>
                                        </td>
                                        <td>
                                            <div type-i18n-unit unit="main_type.space.unit||userArea" data="i18nArea" ng-model="main_type.space" placeholder="面积"></div>
                                        </td>
                                        <td>
                                            <div type-i18n-unit unit="main_type.total_price.unit||userCurrency" data="i18nCurrency" ng-model="main_type.total_price" placeholder="户型总价"></div>
                                        </td>
                                        <td>
                                            <div type-i18n="main_type.floor_plan"></div>
                                            <single-image-edit ng-model="main_type.floor_plan[userLanguage.value]" width-limit="1920" ratio="2"
                                                thumbnail-size="800,400"
                                                text="户型图" style="width: 200px;"></single-image-edit>
                                        </td>
                                        <td>
                                            <span class="btn btn-danger" ng-click="onRemoveHouse($index)" title="Remove">
                                                <i class="fa fa-trash-o"></i>
                                            </span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="9">
                                            <input type="button" ng-click="addHouse()" class="btn btn-primary" value="添加户型"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12">
                        <label class="control-label">效果图</label>

                        <div class="controls">
                            <div type-i18n="item.effect_pictures"></div>
                            <images-edit ng-model="item.effect_pictures[userLanguage.value]" width-limit="1920" ratio="2"
                                text="添加图片" thumbnail-size="800,400"></images-edit>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12">
                        <label class="control-label">室内样板间图</label>

                        <div class="controls">
                            <div type-i18n="item.indoor_sample_room_picture"></div>
                            <images-edit ng-model="item.indoor_sample_room_picture[userLanguage.value]" width-limit="1920" ratio="2"
                                text="添加图片" thumbnail-size="800,400"></images-edit>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-12 col-sm-12">
                        <label class="control-label">规划图</label>

                        <div class="controls">
                            <div type-i18n="item.planning_map"></div>
                            <images-edit ng-model="item.planning_map[userLanguage.value]" width-limit="1920" ratio="2"
                                text="添加图片" thumbnail-size="800,400"></images-edit>
                        </div>
                    </div>
                </div>
            </tab>
            <tab heading="房产审核单">
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">审核备注</label>

                        <div class="controls">
                            <input type="text" class="form-control" ng-model="item.comment"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-xs-6 col-sm-3">
                        <label class="control-label">审核附件</label>

                        <div class="controls">
                            <files-edit ng-model="item.attachment" text="上传附件"></files-edit>
                        </div>
                    </div>
                </div>
            </tab>
        </tabset>
        <input type="submit" class="btn btn-primary" value="创建草稿" ng-if="userLanguage.value && userArea && userCurrency">
        <input type="button" class="btn btn-primary" value="提交审核" ng-if="userLanguage.value && userArea && userCurrency" ng-click="submitForReview($event,createProperty)">
    </form>
</div>
