<!--@@master=masters/master.html-->
<!--@@block=head -->
<!--build:css(dist) /static/styles/index.html.css-->
<link rel="stylesheet" href="/static/styles/project/houseCard.css"/>
<link rel="stylesheet" href="/static/styles/project/processCard.css"/>
<link rel="stylesheet" href="/static/styles/index.css"/>
<!--endbuild-->
<!--@@close-->
<!--@@block=main -->
<div class="gallery">
    %if homepage_ad_list:
        <div class="rslides_wrapper">
            <ul class="rslides" data-init="false">
                % for ad in homepage_ad_list:
                    <li>
                        <div class="img hiddenOnMobile" style="background:url('{{!fetch_image(ad.get('image'), content_id=ad.get('id'))}}') no-repeat;background-size: cover; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='{{!fetch_image(ad.get('image'), content_id=ad.get('id'))}}', sizingMethod='scale');" data-url="{{!fetch_image(ad.get('image'), content_id=ad.get('id'))}}">
                            <div class="img_shadow"></div>
                        </div>
                        <div class="img hiddenOnPCWeb" style="background:url('{{!fetch_image(ad.get('image'), content_id=ad.get('id'))}}_thumbnail') no-repeat;background-size: cover; filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src='{{!fetch_image(ad.get('image'), content_id=ad.get('id'))}}_thumbnail', sizingMethod='scale');" data-url="{{!fetch_image(ad.get('image'), content_id=ad.get('id'))}}_thumbnail">
                            <div class="img_shadow"></div>
                        </div>
                        <div class="imageText_table">
                            <div class="imageText_wrapper">
                                <div class="imageText">
                                    %for index, text in enumerate(ad.get('text')):
                                        <h1 class="slogan">{{text}}</h1>
                                    %end
                                    <a class="button red" href="{{ad.get('link')}}">{{ad.get('image_alt','')}}</a>
                                </div>
                            </div>
                        </div>
                    </li>
                % end
            </ul>
        </div>
    %end
</div>

<div class="userChoice_wrapper">
    <ul class="userChoice">
            <li>
                <a
                    %if is_mobile_client():
                        href="#" onclick="window.bridge.callHandler(&quot;createRentTicket&quot;);return false;"
                    %else:
                        href="/property-to-rent/create"
                    %end
                    >
                    <i class="img_wrapper icon-calender_homepage"></i>
                    <div class="text">
                        <h3 class="question">
                            {{_('出租海外房产？')}}
                        </h3>
                        <label class="choice">
                            {{_('极速发布，覆盖全英')}}
                        </label>
                    </div>
                </a>
            </li>
        <li>
            <a href="/guides">
                <i class="img_wrapper icon-house_homepage"></i>
                <div class="text">
                    <h3 class="question">
                        {{_('首次海外置业？')}}
                    </h3>
                    <label class="choice">
                        {{_('先读读海外置业指南')}}
                    </label>
                </div>
            </a>
        </li>
        <li>
            <a
                %if is_mobile_client():
                    href="#" onclick="window.bridge.callHandler(&quot;openPropertyListTab&quot;);return false;"
                %else:
                    href="/property-list"
                %end
                >
                <i class="img_wrapper icon-search_homepage"></i>
                <div class="text">
                    <h3 class="question">
                        {{_('已经有置业目标？')}}
                    </h3>
                    <label class="choice" >
                        {{_('开始选房吧')}}
                    </label>
                </div>
            </a>
        </li>
        <li>
            <a style="cursor:pointer;" onclick="javascript:window.project.openRequirement(null, null, null)">
                <i class="img_wrapper icon-files_homepage"></i>
                <div class="text last">
                    <h3 class="question">
                        {{_('立即提交置业需求？')}}
                    </h3>
                    <label class="choice"  style="cursor:pointer;" onclick="javascript:window.project.openRequirement(null, null, null)">
                        {{_('让置业顾问帮我选房')}}
                    </label>
                </div>
            </a>
        </li>
    </ul>

</div>

%if not user:
    <div class="howItWorks">
        <!-- @@include=partials/how_it_works_tabs.html-->
    </div>
    <div class="howItWorks_phone">
        <label class="title">{{_('为您推荐')}}</label>
        <ul class="controls">
            % for index, intention in enumerate(intention_list):
                % slug = intention.get('slug','')
                <li style="width: {{99.99 / 3}}%" data-tab="{{slug}}"
                    data-id="{{intention.get('id')}}"
                    data-value="{{intention.get('value')}}">
                    <a href="/how_it_works?slug={{slug}}">
                        <img alt="" src="/static/images/intention/icon/{{slug}}-red.png"/>
                        <label for="{{intention.get('id')}}">{{intention.get('value')}}</label>
                    </a>
                </li>
            %end
        </ul>
    </div>
%end

%if announcement_list:
    %if user:
        <div class="announcement_wrapper" style="background:#eee">
            <div id="announcement" class="announcement" style="border-bottom: 0px solid #ccc;">
                <ul>
                    %for index, anno in enumerate(announcement_list):
                        <li class="item">
                            <i class="icon icon-message_notice"></i>
                            <a class="title" href="/news/{{anno.get('id')}}">{{anno.get('title', '')}}</a>
                            <a class="more" href="/notice-list">{{_('更多公告')}}</a>
                            <img class="close" style="display:none" alt="" src="/static/images/index/announcement_close.png"/>
                        </li>
                    %end
                </ul>
            </div>
        </div>
    %else:
        <div class="announcement_wrapper">
            <div id="announcement" class="announcement">
                <ul>
                    % for anno in announcement_list:
                        <li class="item">
                            <i class="icon icon-message_notice"></i>
                            <a class="title" href="/news/{{anno.get('id')}}">{{anno.get('title', '')}}</a>
                            <a class="more" href="/notice-list">{{_('更多公告')}}</a>
                            <img class="close" style="display:none" alt="" src="/static/images/index/announcement_close.png"/>
                        </li>
                    % end
                </ul>
            </div>
        </div>
    %end
%end

%if user:
    <textarea id="dataBudgetList" style="display:none;">{{json_dumps(budget_list)}}</textarea>
    <textarea id="dataIntentionList" style="display:none">
    {{json_dumps(intention_list)}}
    </textarea>
    <div class="tags_wrapper" name="intentionForm">
        <div id="tags" class="tags">
            <h2 class="title">{{_('为您推荐')}}</h2>

            <div id="budgetTag" class="budget">
                <label class="hint" for="">{{_('您的预算')}}
                    (
                    {{_('单选')}},
                    <!--@@include=partials/current_currency.html -->
                    ):&nbsp;</label>
                %for index, budget in enumerate(budget_list):
                    %if budget.get('currency') == _.currency:
                        <div class="toggleTag" data-id="{{budget.get('id')}}">{{budget.get('value')}}</div>
                    %end
                %end
            </div>
            <div id="intentionTag" class="intention">
                <label class="hint" for="">{{_('投资意向(多选)')}}:&nbsp;</label>
                <ul id="list">

                </ul>
                <button id="add" class="ghostButton red add">
                    <img alt="" src="/static/images/intention/add.png"/> {{_('添加')}}
                </button>
                <div id="suggestionTip" class="suggestionTip" style="display:none">
                    <p>{{_('获取为您推荐的房产投资机会')}}</p>
                </div>
            </div>
        </div>
        <div class="intentionTabs_wrapper" style="height:0;">
            <a class="howItWorks_button ghostButton red" href="/how_it_works">{{_('查看标签说明')}}</a>
            <!-- @@include=partials/intention_tabs.html-->
            <img class="collapseButton" id="collapseButton" src="/static/images/intention/collapse.png"
                 style="cursor: pointer;"/>
        </div>
    </div>
%end

%if not user:
    <textarea id="dataPropertyList" style="display:none">
    {{json_dumps(property_list)}}
    </textarea>
    <div class="houseFeatured">
        % for property in property_list:
            <!-- @@include=/static/templates/featured_house_card.html -->
        % end
    </div>
%else:
    <div id="suggestionHouses" class="suggestionHouses">
        <img src="/static/images/common/ajax-loader.gif" id="loadIndicator" class="loadIndicator" style="display:none"/>

        <div id="list" class="list">
        </div>
    </div>
%end

%if news_list :
    <div class="news_wrapper">
        <div class="news">
            <h2 class="title">
                {{_('资讯')}}
            </h2>

            <div class="featuredNews">
                % news = news_list[0]
                %if ('images' in news) and news.get('images'):
                    <a href="/news/{{news_list[0].get('id')}}" style="text-decoration:none;"><img alt="{{news_list[0].get('title', '')}}" class="picture" src="{{!fetch_image(news.get('images')[0], thumbnail=True, news_id=news.get('id'))}}"/></a>
                %end
                <div class="content_wrapper">
                    <a href="/news/{{news_list[0].get('id')}}" style="text-decoration:none;"><h3 class="title">
                        {{news_list[0].get('title', '')}}</h3></a>

                    <p class="content">
                        {{!news_list[0].get('summary', '')}}
                    </p>
                    <a class="ghostButton red detail" href="/news/{{news_list[0].get('id')}}">{{_('详细')}}</a>
                </div>
            </div>

            %if len(news_list) > 1 :
                <div class="moreNews">
                    <h3 class="title">{{_('更多资讯')}}</h3>

                    <div class="list">
                        %for index, item in enumerate(news_list):
                            %if index > 0 and index < 6:
                                <a class="item" href="/news/{{item.get('id')}}">{{item.get('title', '')}}</a>
                            %end
                        %end
                    </div>
                    <a class="ghostButton red more" href="/news-list">{{_('了解更多')}}</a>
                </div>
            %end
        </div>
    </div>
%end

<ul class="floatBar_phone hiddenInClient">
    <li class="phone"><a href="tel:{{get_phone_numbers('link')[0]}}"><i></i>{{_(u'拨打')+get_phone_numbers('display')[0]+_(u'咨询')}}</a></li>
    <li class="requirement"><a href="/requirement"><i class="icon-requirement_bottom"></i></a></li>
</ul>

<!-- @@include=/static/templates/suggestion_house_card.tpl.html -->

<!-- @@include=/static/templates/suggestion_empty_house_card.tpl.html -->

<!--@@close-->

<!--@@block=scripts -->
<script>

 $(function () {
     $(".rslides").responsiveSlides({
         pager: true
     })
 })
    window.iconMap = {
        'school_nearby_house': 'category_b',
        'off_plan_property': 'category_e',
        'existing_property': 'category_d',
        'rental_guarantee': 'category_a'
    }
</script>
<!--build:js /static/scripts/index.html.js-->
<script src="/static/scripts/index.js"></script>
<!--endbuild-->
<!--@@close-->
